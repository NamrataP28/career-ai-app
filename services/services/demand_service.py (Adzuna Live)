import requests
import os
from dotenv import load_dotenv

load_dotenv()

class DemandService:

    def get_live_demand(self, role, country="gb"):
        url = f"https://api.adzuna.com/v1/api/jobs/{country}/search/1"
        params = {
            "app_id": os.getenv("ADZUNA_APP_ID"),
            "app_key": os.getenv("ADZUNA_APP_KEY"),
            "results_per_page": 1,
            "what": role
        }
        try:
            response = requests.get(url, params=params)
            data = response.json()
            return data.get("count", 0)
        except:
            return 0
